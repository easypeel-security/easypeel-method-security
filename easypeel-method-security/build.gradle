apply plugin: 'java'
apply plugin: 'java-library'
pluginManager.apply("com.github.johnrengelman.shadow")
pluginManager.apply("com.vanniktech.maven.publish")

java {
    sourceCompatibility = JavaVersion.VERSION_17
}

dependencies {
    implementation "com.squareup:javapoet:${javapoetVersion}"
    implementation "org.springframework.boot:spring-boot-starter-aop:${springAopVersion}"
    implementation "org.springframework:spring-context:${springContextVersion}"
    implementation "org.springframework.boot:spring-boot-starter-web:${springBootVersion}"
    implementation "com.github.ben-manes.caffeine:caffeine:${caffeineVersion}"
    implementation 'jakarta.servlet:jakarta.servlet-api:5.0.0'
}

shadowJar {
    archiveBaseName.set(projectName)
    archiveVersion.set(projectVersion)
    archiveClassifier.set("")
    archiveExtension.set("jar")
}

jar.enabled = false

tasks.register('sourcesJar', Jar) {
    from sourceSets.main.allSource
    archiveClassifier.set("sources")
}

tasks.register('javadocJar', Jar) {
    from javadoc
    archiveClassifier.set("javadoc")
}

publishing {
    publications {
        shadow(MavenPublication) {
            artifact shadowJar
            artifact sourcesJar
            artifact javadocJar
        }
    }
}
