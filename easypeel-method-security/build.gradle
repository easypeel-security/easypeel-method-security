plugins {
    id 'com.github.johnrengelman.shadow' version '8.1.1'
}

dependencies {
    implementation "com.squareup:javapoet:${javapoetVersion}"
    compileOnly "org.springframework.boot:spring-boot-starter-aop:${springAopVersion}"
    implementation "org.springframework:spring-context:${springContextVersion}"
    implementation "com.github.ben-manes.caffeine:caffeine:${caffeineVersion}"
}

shadowJar {
    archiveBaseName.set(project.name)
    archiveClassifier.set('')
    archiveVersion.set("${version}")
    configurations = [project.configurations.compileClasspath]
    dependencies {
        exclude(dependency -> {
            return !(dependency.name.contains("org.aspectj") || dependency.name.contains("org.springframework.stereotype") || dependency.name.contains("com.github.ben-manes"))
        })
    }
}